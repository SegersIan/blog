<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>How To Control Music With A PS4 DualShock and JavaScript | segersian.com</title>
    <meta name="description" content="Control your music software and instruments with your Gamepad.">
    <meta name="generator" content="VuePress 1.3.1">
    
    
    <link rel="preload" href="/assets/css/0.styles.856afaa1.css" as="style"><link rel="preload" href="/assets/js/app.0ad86bdc.js" as="script"><link rel="preload" href="/assets/js/7.a7035712.js" as="script"><link rel="preload" href="/assets/js/4.378bc263.js" as="script"><link rel="preload" href="/assets/js/13.54549519.js" as="script"><link rel="prefetch" href="/assets/js/1.b02bdb47.js"><link rel="prefetch" href="/assets/js/10.52d134ef.js"><link rel="prefetch" href="/assets/js/11.a095afa2.js"><link rel="prefetch" href="/assets/js/12.24361ebb.js"><link rel="prefetch" href="/assets/js/14.47490054.js"><link rel="prefetch" href="/assets/js/15.ec331b63.js"><link rel="prefetch" href="/assets/js/16.0785068b.js"><link rel="prefetch" href="/assets/js/17.8611f67d.js"><link rel="prefetch" href="/assets/js/18.aa48a65a.js"><link rel="prefetch" href="/assets/js/19.e0274d39.js"><link rel="prefetch" href="/assets/js/20.13abfd88.js"><link rel="prefetch" href="/assets/js/21.ea6c910f.js"><link rel="prefetch" href="/assets/js/22.d4bbf0da.js"><link rel="prefetch" href="/assets/js/23.cbb64ab0.js"><link rel="prefetch" href="/assets/js/24.4ee4c4ce.js"><link rel="prefetch" href="/assets/js/25.355362c3.js"><link rel="prefetch" href="/assets/js/5.ad74a638.js"><link rel="prefetch" href="/assets/js/6.0af69b82.js"><link rel="prefetch" href="/assets/js/8.523d3122.js"><link rel="prefetch" href="/assets/js/9.2d7f0a87.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.0ba5ebcb.js">
    <link rel="stylesheet" href="/assets/css/0.styles.856afaa1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/" class="nav-link home-link">segersian.com </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/" class="nav-link">Posts</a></li><li class="nav-item"><a href="/tag/" class="nav-link">Tags</a></li><li class="nav-item"><a href="https://www.segersian.com" target="_blank" rel="noopener noreferrer" class="nav-link external">SegersIan.com</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/" class="nav-link mobile-home-link">segersian.com </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/" class="nav-link">Posts</a></li><li class="mobile-nav-item"><a href="/tag/" class="nav-link">Tags</a></li><li class="mobile-nav-item"><a href="https://www.segersian.com" target="_blank" rel="noopener noreferrer" class="nav-link external">SegersIan.com</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        How To Control Music With A PS4 DualShock and JavaScript
      </h1> <div class="post-meta"><!----> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <time pubdate itemprop="datePublished" datetime="2019-06-03T00:00:00.000Z">
      2019-06-03
    </time></div> <ul itemprop="keywords" class="post-meta-tags"><li class="post-tag" data-v-d832e844><a href="/tag/Javascript" data-v-d832e844> Javascript </a></li><li class="post-tag" data-v-d832e844><a href="/tag/Web API" data-v-d832e844> Web API </a></li><li class="post-tag" data-v-d832e844><a href="/tag/Gamepad API" data-v-d832e844> Gamepad API </a></li></ul></div></header> <div itemprop="articleBody" class="content__default"><p><em>Published originally on <a href="https://itnext.io/how-to-control-music-with-a-ps4-dualshock-and-javascript-54237206c104" target="_blank" rel="noopener noreferrer">Medium<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></em></p> <p><em>Recently I wrote an article on <a href="/_posts/2019-05-30-how-not-to-interact-with-your-web-app-with-a-ps4-controller.html">how (not) to connect your PS4 DualShock</a> to your web applications. After finding out about the Gamepad API, I finally could try to control my music software, with a PS4 DualShock. I’ve used the Web MIDI API and the Web Gamepad API to make this happen. Why? Just because we can.</em></p> <p><strong>If you just want to see a working example, scroll down to the bottom to check out the final video.</strong></p> <p><em>If you don’t have a PS4 DualShock, you can just check out the videos below where I showcase the working examples. In case you don’t have Traktor, you can use free software to monitor if proper MIDI events are being sent instead of using Traktor, read further for more information.</em></p> <h2 id="the-goal"><a href="#the-goal" class="header-anchor">#</a> The Goal</h2> <p>My goal is to control my DJ software, being Traktor, from the browser controls or using my PS4 DualShock, but still using the browser as the main hub. You might ask, “why to use the browser instead of writing native code?”. Reason being, I wanted to discover and explore the modern browser APIs.</p> <h2 id="the-strategy"><a href="#the-strategy" class="header-anchor">#</a> The Strategy</h2> <p>Music instruments and music software (e.g. software for producing or DJs) use a technology which is called MIDI, which stands for “Music Instrument Digital Interface”. This universal digital interface allows music instruments (e.g. synthesizer) to communicate with other instruments, controllers or software.</p> <p>Conveniently, modern browsers (I’ll be using Chrome v74+), although still an experimental, implement the <a href="https://www.w3.org/TR/webmidi/" target="_blank" rel="noopener noreferrer">MIDI API<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Meaning, from within the browser we can act as a controller that “receives” and “sends” MIDI messages. This means that a web application can communicate with, for example, DJ Software which is running on the same machine as the client that has the web application running in the browser.</p> <p>In addition to the possibility to communicate with Traktor (DJ software) from the browser, we can also use the Gamepad API to communicate with any gamepad, but I’ll be using a PS4 DualShock connected by a USB cable (sorry, no Bluetooth support!).</p> <p>The web application which runs in the browser will be the central hub that will read the user actions on the gamepad and translates this in MIDI communication that we send to our DJ Software.</p> <h2 id="about-midi"><a href="#about-midi" class="header-anchor">#</a> About MIDI</h2> <p>When we want to communicate over MIDI, we need to understand how the protocol works. The MIDI specification defines the hardware connectors, but also the contract of the data that we sent over the MIDI connectors. I’ll skip the hardware part, as we won’t need that knowledge (<a href="https://en.wikipedia.org/wiki/MIDI" target="_blank" rel="noopener noreferrer">More info<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>).</p> <p>MIDI communication happens through “MIDI Messages”. A Midi Message (usually) exists out of 1, 2, or 3 bytes. The first byte is always a “Status”-byte and the following 2 or 3 bytes are known as “data bytes”. The status byte its <a href="https://en.wikipedia.org/wiki/Bit_numbering#Most_significant_bit" target="_blank" rel="noopener noreferrer">MSB<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> is always “1” and a data byte its MSB is always “0”. Which means, the value of a status byte will be always between 128 and 255, while the value of a data byte will be always between 0 and 127. Based on this knowledge, when seeing a MIDI byte, we can immediately determine if we have a status or data byte.</p> <p>A status byte usually maps to a specific “function”, while the data bytes provide corresponding data. For example, we get a status byte which translates to “change track”, then the following data byte should contain the track #. You can find the entire mapping of what each status byte means and corresponding data bytes over <a href="https://www.midi.org/specifications-old/item/table-2-expanded-messages-list-status-bytes" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and <a href="https://www.midi.org/specifications-old/item/table-3-control-change-messages-data-bytes-2" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>No need to learn or know all the nitty-gritty details, but I created a small <a href="https://webapistudio.com/#/midi/debugger" target="_blank" rel="noopener noreferrer">debugger<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> which helps you to understand any MIDI message you might stumble upon.</p> <h2 id="the-scope"><a href="#the-scope" class="header-anchor">#</a> The Scope</h2> <p>As we’re introducing a lot of new stuff like MIDI, MIDI API, Gamepad API, I’ll keep the scope of our final version very small. I have the following requirements:</p> <ul><li>We can control the volume of one “deck” with a slider in the web browser.</li> <li>We can play/pause the music of one “deck” with a single button in the web browser.</li> <li>We can control the volume of one “deck” with two buttons on the gamepad.</li> <li>We can play/pause the music of one “deck” with a single button on the gamepad.</li></ul> <p>In Traktor, the DJ software that I will be using for this, a “deck” is like a single channel, like a CD player or turntable that can play one track at a time. Usually, you have 2 or more decks in a music software as you can then mix and blend multiple channels/tracks.</p> <h2 id="the-implementation"><a href="#the-implementation" class="header-anchor">#</a> The Implementation</h2> <p>We’ll skip the part of creating a fancy GUI, as this would draw us away from the core challenge, have a look at the source code of <a href="https://webapistudio.com/#/" target="_blank" rel="noopener noreferrer">WebApiStudio.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> if you want to see how I implemented things in VueJs.</p> <h3 id="requirement-1-control-volume-of-one-deck-with-a-slider"><a href="#requirement-1-control-volume-of-one-deck-with-a-slider" class="header-anchor">#</a> Requirement 1: Control volume of one deck with a slider</h3> <p>We start off with creating a simple slider on an HTML page. We set the min value to <code>0</code> and max value to <code>127</code>. Remember that our “data” bytes have a range of 0 to 127. Therefore we want our volume slider to limit its range for convenience.</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>volume<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Volume:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>volume<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>range<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>volume<span class="token punctuation">&quot;</span></span> <span class="token attr-name">min</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">max</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>127<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">const</span> volumeSlider <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'volume'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    volumeSlider<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>We are now just listening to the <code>input</code> event of the slider. Making sure that when we slide the slider from left to right that our min is <code>0</code> and max <code>127</code> .</p> <p>Now we want to send a MIDI Message to an actual MIDI “output”. The “output” we use to send MIDI Messages to, the “Input” we use to receive MIDI messages from. You can have always multiple input and outputs available.</p> <p><em>If you don’t have <a href="https://www.native-instruments.com/en/products/traktor/dj-software/" target="_blank" rel="noopener noreferrer">Traktor<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> installed, I suggest you install a <a href="https://www.snoize.com/MIDIMonitor/" target="_blank" rel="noopener noreferrer">MIDI Monitor<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> which can act as a “fake” output to listen to received MIDI messages, ideal for debugging purposes. If you use the MIDI Monitor, make sure that you enable “Act as destination for other programs” once you launched it.</em></p> <p><strong>If you are using Traktor, we need to first do some prep work.</strong></p> <ul><li>Start Traktor</li> <li>Open <code>settings</code> &gt; <code>Controller Manager</code> &gt; Select <code>Generic MIDI</code> as device.</li> <li>If you don’t have <code>Generic MIDI</code> available, click the <code>add</code> button and choose <code>Generic MIDI</code>.</li> <li>Select for <code>in-port</code> the value <code>traktor virtual input</code></li> <li>Click <code>add in</code> &gt; <code>mixer</code> &gt; <code>volume adjust</code> .</li> <li>In the <code>device mapping</code> , click on the <code>n/a</code> dropdown and select <code>ch01 — CC — 006</code> .</li> <li>In the <code>mapping details</code> choose <code>deck a</code> for the <code>assignment</code></li> <li>You can see all the steps in this <a href="https://www.youtube.com/watch?v=k0sHmLw4gzc&amp;feature=youtu.be" target="_blank" rel="noopener noreferrer">video<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li></ul> <p>Now that Traktor is ready to listen to our MIDI mapping, we can tie things together.</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>volume<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Volume:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>volume<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>range<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>volume<span class="token punctuation">&quot;</span></span> <span class="token attr-name">min</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">max</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>127<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">const</span> volumeSlider <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'volume'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    volumeSlider<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> midiAccess <span class="token operator">=</span> <span class="token keyword">await</span> navigator<span class="token punctuation">.</span><span class="token function">requestMIDIAccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// If you use &quot;MIDI Monitor&quot; use as name &quot;'MIDI Monitor (Untitled)'&quot;</span>
        <span class="token comment">// If you use Traktor use as name &quot;Traktor Virtual Input&quot;</span>
        <span class="token keyword">const</span> midiOutputName <span class="token operator">=</span> <span class="token string">'Traktor Virtual Input'</span><span class="token punctuation">;</span>

        <span class="token keyword">const</span> output <span class="token operator">=</span> <span class="token function">getMidiOutputByName</span><span class="token punctuation">(</span>midiAccess<span class="token punctuation">.</span>outputs<span class="token punctuation">,</span> midiOutputName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>output<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> midiMessage <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">176</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token function">Number</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            output<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>midiMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Sent </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>midiMessage<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>output<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'No MIDI Output found'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">getMidiOutputByName</span><span class="token punctuation">(</span><span class="token parameter">outputs<span class="token punctuation">,</span> name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> output <span class="token keyword">of</span> outputs<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>output<span class="token punctuation">.</span>name <span class="token operator">===</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> output<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>When we now move the slider around, we will send a midi message of 3 bytes ([176, 6, currentSliderValue]) to our Traktor output (which annoyingly has the name “input” in it). We could optimize the code so we only fetch the outputs once, but these are improvements that I don’t want to focus on for now.</p> <p>If we would run this page now, with Traktor (or MIDI Monitor) running in the background with the proper configuration we should get the following result:</p> <p><a href="https://www.youtube.com/watch?v=ZuySPFME5Kk" target="_blank" rel="noopener noreferrer">See Video<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>As you can see, when I move the slider in the web page, the volume slider of my <code>deck a</code> changes accordingly. Sadly, when I load the page, with this code snippet I cannot query the “current” state of the volume slider in Traktor. Fixing this is out of our scope.</p> <h3 id="requirement-2-add-play-resume-button"><a href="#requirement-2-add-play-resume-button" class="header-anchor">#</a> Requirement 2: Add Play/Resume button</h3> <p>We will add now a simple button that will pause or resume our loaded track in <code>deck a</code> . Again, if you are using Traktor, we need to configure a new MIDI mapping in our Traktor controller manager.</p> <ul><li>Open <code>settings</code> &gt; <code>Controller Manager</code> &gt; Select <code>Generic MIDI</code> as device.</li> <li>Click <code>add in</code> &gt; <code>deck common</code> &gt; <code>play/pause</code> .</li> <li>In the <code>device mapping</code> , click on the <code>n/a</code> dropdown and select <code>ch01 — CC — 007</code> . Also, set the interaction mode to toggle. This way we toggle between <code>play</code> and <code>pause</code> basically.</li> <li>In the <code>mapping details</code> choose <code>deck a</code> for the <code>assignment</code></li> <li>You can see all the steps in this <a href="https://www.youtube.com/watch?v=_ikSrETH9tQ&amp;feature=youtu.be" target="_blank" rel="noopener noreferrer">video<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li></ul> <p>I have refactored the code a bit to avoid duplication, but basically, I just added a button that will send the correct MIDI Message that maps to our play/pause action.</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>volume<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Volume:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>volume<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>range<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>volume<span class="token punctuation">&quot;</span></span> <span class="token attr-name">min</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">max</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>127<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>play<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Play/Pause<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">

    <span class="token comment">// Attach Event Listener for the volume slider</span>
    <span class="token keyword">const</span> volumeSlider <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'volume'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    volumeSlider<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> output <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getMidiOutput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>output<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> midiMessage <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">176</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token function">Number</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            output<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>midiMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Sent </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>midiMessage<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>output<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'No MIDI Output found'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Attach Event Listener for the play/pause button</span>
    <span class="token keyword">const</span> playBtn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'play'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    playBtn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> output <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getMidiOutput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>output<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> midiMessage <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">176</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            output<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>midiMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Sent </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>midiMessage<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>output<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'No MIDI Output found'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getMidiOutput</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// If you use &quot;MIDI Monitor&quot; use as name &quot;'MIDI Monitor (Untitled)'&quot;</span>
        <span class="token comment">// If you use Traktor use as name &quot;Traktor Virtual Input&quot;</span>
        <span class="token keyword">const</span> midiOutputName <span class="token operator">=</span> <span class="token string">'Traktor Virtual Input'</span><span class="token punctuation">;</span>

        <span class="token keyword">const</span> midiAccess <span class="token operator">=</span> <span class="token keyword">await</span> navigator<span class="token punctuation">.</span><span class="token function">requestMIDIAccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> output <span class="token keyword">of</span> midiAccess<span class="token punctuation">.</span>outputs<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>output<span class="token punctuation">.</span>name <span class="token operator">===</span> midiOutputName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> output<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br></div></div><p><a href="https://www.youtube.com/watch?v=J_3a9BSRtv8" target="_blank" rel="noopener noreferrer">We can see it in action in this video<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Seems to be working just fine! The volume slider still works and also the play button does its job.</p> <p><em>We were able to make a working example that we can control Traktor from the browser with the help of custom MIDI mapping. It is possible to also make it work in the other direction. When I would change the volume in Traktor, we would auto adjust the slider in the web browser. We can accomplish this with a <code>out</code> mapping instead of an <code>in</code> mapping that we configured in Traktor and both can work side by side. We won’t cover that in detail, but worth mentioning.</em></p> <h3 id="requirement-3-control-the-volume-with-a-gamepad"><a href="#requirement-3-control-the-volume-with-a-gamepad" class="header-anchor">#</a> Requirement 3: Control the volume with a gamepad.</h3> <p>As we now understand how we can control Traktor via MIDI, we can now use the gamepad API to use our PS4 DualShock. The behavior will be a bit buggy because of the nature of how the Gamepad API works. We need to “poll” the state of the gamepad periodically to check what buttons are being pressed.</p> <p>Meaning, we might register a button click multiple times or not at all depending on how long we keep a button pressed and based on our “polling” interval. We can avoid this behavior by using RxJs, but I don’t want too much code for our proof-of-concept so I’ll just accept the potential awkward behavior.</p> <p><em>We need to connect our PS4 DualShock with a USB cable to our local machine. No special software is required, if you use a mac, check out this tutorial, else Google is your friend. Although they give advice on how to connect it over Bluetooth, use the USB cable approach.</em></p> <p>For this example, I’ll use the navigation buttons of our PS4 DualShock. The <strong>up</strong> button has id/index <code>12</code> and the <strong>down</strong> button has id/index 13. A full mapping can be found <a href="https://webapistudio.com/#/gamepad/debugger" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p><img src="/assets/img/how-to-control-music-with-a-ps4-dualshock-and-javascript_01.61041879.png" alt="PS4 Controller"></p> <p>Here is the code:</p> <div class="language-html line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">

    <span class="token keyword">const</span> <span class="token constant">POLL_INTERVAL</span> <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token constant">MAX_VOLUME</span> <span class="token operator">=</span> <span class="token number">127</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token constant">MIN_VOLUME</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> currentVolume <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token function">setInterval</span><span class="token punctuation">(</span>getButtonsState<span class="token punctuation">,</span> <span class="token constant">POLL_INTERVAL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getButtonsState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// We can connect up to 4 gamepads at the same time</span>
        <span class="token comment">// By default our single gamepad will be available at index 0</span>
        <span class="token keyword">const</span> gamepad <span class="token operator">=</span> navigator<span class="token punctuation">.</span><span class="token function">getGamepads</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gamepad<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'No gamepad found.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">const</span> buttonUp <span class="token operator">=</span> gamepad<span class="token punctuation">.</span>buttons<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> buttonDown <span class="token operator">=</span> gamepad<span class="token punctuation">.</span>buttons<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> midiOutput <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getMidiOutput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>buttonUp<span class="token punctuation">.</span>pressed <span class="token operator">&amp;&amp;</span> currentVolume <span class="token operator">&lt;</span> <span class="token constant">MAX_VOLUME</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            currentVolume <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            midiOutput<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">176</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> currentVolume<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Registered a button up, increasing volume'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>buttonDown<span class="token punctuation">.</span>pressed <span class="token operator">&amp;&amp;</span> currentVolume <span class="token operator">&gt;</span> <span class="token constant">MIN_VOLUME</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            currentVolume <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            midiOutput<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">176</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> currentVolume<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Registered a button down, decreasing volume'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getMidiOutput</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// If you use &quot;MIDI Monitor&quot; use as name &quot;'MIDI Monitor (Untitled)'&quot;</span>
        <span class="token comment">// If you use Traktor use as name &quot;Traktor Virtual Input&quot;</span>
        <span class="token keyword">const</span> midiOutputName <span class="token operator">=</span> <span class="token string">'Traktor Virtual Input'</span><span class="token punctuation">;</span>

        <span class="token keyword">const</span> midiAccess <span class="token operator">=</span> <span class="token keyword">await</span> navigator<span class="token punctuation">.</span><span class="token function">requestMIDIAccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> output <span class="token keyword">of</span> midiAccess<span class="token punctuation">.</span>outputs<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>output<span class="token punctuation">.</span>name <span class="token operator">===</span> midiOutputName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> output<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br></div></div><p>I removed the HTML controls/buttons for clarity of the example. At line <code>12</code> we start our polling interval which will call <code>getButtonState</code>. This function will get the current state of our <code>up</code> and <code>down</code> button and will adjust the volume accordingly. Notice that we do have to keep track of the current volume level so we know what value we need to send (as the volume is expressed with a value between <code>0</code> and <code>127</code>).</p> <p><a href="https://www.youtube.com/watch?v=nTP090gVIKg" target="_blank" rel="noopener noreferrer">Here is a small video showing our code in action.<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Works like a charm! Now let’s move to the final stage.</p> <h3 id="requirement-4-control-play-pause-with-a-gamepad"><a href="#requirement-4-control-play-pause-with-a-gamepad" class="header-anchor">#</a> Requirement 4: Control Play/Pause with a gamepad.</h3> <p>For the convenience of me being able to film when I showcase the working example, I will use the navigation button <code>right</code> (id/index <code>15</code>) to function as the play/pause button. We just need to extend the <code>getButtonState</code> function to also register any button presses on it and sent out the corresponding MIDI message.</p> <div class="language-html line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">

    <span class="token keyword">const</span> <span class="token constant">POLL_INTERVAL</span> <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token constant">MAX_VOLUME</span> <span class="token operator">=</span> <span class="token number">127</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token constant">MIN_VOLUME</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> currentVolume <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token function">setInterval</span><span class="token punctuation">(</span>getButtonsState<span class="token punctuation">,</span> <span class="token constant">POLL_INTERVAL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getButtonsState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// We can connect up to 4 gamepads at the same time</span>
        <span class="token comment">// By default our single gamepad will be available at index 0</span>
        <span class="token keyword">const</span> gamepad <span class="token operator">=</span> navigator<span class="token punctuation">.</span><span class="token function">getGamepads</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gamepad<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'No gamepad found.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">const</span> buttonUp <span class="token operator">=</span> gamepad<span class="token punctuation">.</span>buttons<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> buttonDown <span class="token operator">=</span> gamepad<span class="token punctuation">.</span>buttons<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> buttonRight <span class="token operator">=</span> gamepad<span class="token punctuation">.</span>buttons<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> midiOutput <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getMidiOutput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>buttonUp<span class="token punctuation">.</span>pressed <span class="token operator">&amp;&amp;</span> currentVolume <span class="token operator">&lt;</span> <span class="token constant">MAX_VOLUME</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            currentVolume <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            midiOutput<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">176</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> currentVolume<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Registered a button up, increasing volume'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>buttonDown<span class="token punctuation">.</span>pressed <span class="token operator">&amp;&amp;</span> currentVolume <span class="token operator">&gt;</span> <span class="token constant">MIN_VOLUME</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            currentVolume <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            midiOutput<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">176</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> currentVolume<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Registered a button down, decreasing volume'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>buttonRight<span class="token punctuation">.</span>pressed <span class="token operator">&amp;&amp;</span> currentVolume <span class="token operator">&gt;</span> <span class="token constant">MIN_VOLUME</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            midiOutput<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">176</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Registered a button right, toggling play/pause'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getMidiOutput</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// If you use &quot;MIDI Monitor&quot; use as name &quot;'MIDI Monitor (Untitled)'&quot;</span>
        <span class="token comment">// If you use Traktor use as name &quot;Traktor Virtual Input&quot;</span>
        <span class="token keyword">const</span> midiOutputName <span class="token operator">=</span> <span class="token string">'Traktor Virtual Input'</span><span class="token punctuation">;</span>

        <span class="token keyword">const</span> midiAccess <span class="token operator">=</span> <span class="token keyword">await</span> navigator<span class="token punctuation">.</span><span class="token function">requestMIDIAccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> output <span class="token keyword">of</span> midiAccess<span class="token punctuation">.</span>outputs<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>output<span class="token punctuation">.</span>name <span class="token operator">===</span> midiOutputName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> output<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br></div></div><p>If you have a look at the code, just minor changes were done. On line <code>24</code> we also get the navigation button <code>right</code> and on line <code>39</code> we send the corresponding MIDI message. Now we can see this all in action in the <a href="https://www.youtube.com/watch?v=wtH8PUZbErY" target="_blank" rel="noopener noreferrer">final video<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>You might notice that the “play/pause” sometimes “stutters”, so it pauses and resumes immediately again. This is an example of what was mentioned before, this is because of the nature of the Gamepad API that we “poll” for the status of the buttons and my interval being too fast, so we register a button press twice in a row.</p> <hr> <p>Today we managed to control Traktor from our web browser and even through our PS4 DualShock using the latest browser Web APIs. The code snippets are far from ideal implementation-wise but they give us a solid example that all these technologies can work together. I creating a more solid implementation on my website, <a href="https://webapistudio.com/#/" target="_blank" rel="noopener noreferrer">WebApiStudio.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> where you can find also other interesting “debuggers” and information regarding the used technologies in this article.</p> <h2 id="summary"><a href="#summary" class="header-anchor">#</a> Summary</h2> <p>Today we learned and showed that we the new browser web APIs provide a wide range of engaging opportunities. From this proof of concept, we can go further and control with an input (like a gamepad) our music software, and even actual music instruments that use MIDI.</p></div> <footer><!----> <hr> <!----></footer></article> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#the-goal" title="The Goal">The Goal</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#the-strategy" title="The Strategy">The Strategy</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#about-midi" title="About MIDI">About MIDI</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#the-scope" title="The Scope">The Scope</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#the-implementation" title="The Implementation">The Implementation</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#requirement-1-control-volume-of-one-deck-with-a-slider" title="Requirement 1: Control volume of one deck with a slider">Requirement 1: Control volume of one deck with a slider</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#requirement-2-add-play-resume-button" title="Requirement 2: Add Play/Resume button">Requirement 2: Add Play/Resume button</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#requirement-3-control-the-volume-with-a-gamepad" title="Requirement 3: Control the volume with a gamepad.">Requirement 3: Control the volume with a gamepad.</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#requirement-4-control-play-pause-with-a-gamepad" title="Requirement 4: Control Play/Pause with a gamepad.">Requirement 4: Control Play/Pause with a gamepad.</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#summary" title="Summary">Summary</a></div></div></div></div> <footer class="footer" data-v-582f9766><div class="footer-left-wrap" data-v-582f9766><ul class="contact" data-v-582f9766><li class="contact-item" data-v-582f9766><a href="https://github.com/SegersIan" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-582f9766><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github" data-v-582f9766><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" data-v-582f9766></path></svg>
          
        </a></li><li class="contact-item" data-v-582f9766><a href="https://twitter.com/SegersIan" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-582f9766><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter" data-v-582f9766><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z" data-v-582f9766></path></svg>
          
        </a></li><li class="contact-item" data-v-582f9766><a href="https://www.SegersIan.com" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-582f9766><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-globe" data-v-582f9766><circle cx="12" cy="12" r="10" data-v-582f9766></circle><line x1="2" y1="12" x2="22" y2="12" data-v-582f9766></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z" data-v-582f9766></path></svg>
          
        </a></li><li class="contact-item" data-v-582f9766><a href="https://www.linkedin.com/in/segersian/" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-582f9766><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-linkedin" data-v-582f9766><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z" data-v-582f9766></path><rect x="2" y="9" width="4" height="12" data-v-582f9766></rect><circle cx="4" cy="4" r="2" data-v-582f9766></circle></svg>
          
        </a></li><li class="contact-item" data-v-582f9766><a href="mailto:ask@segersian.com" class="nav-link external" data-v-582f9766><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail" data-v-582f9766><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" data-v-582f9766></path><polyline points="22,6 12,13 2,6" data-v-582f9766></polyline></svg>
          
        </a></li></ul></div> <div class="footer-right-wrap" data-v-582f9766><ul class="copyright" data-v-582f9766><li class="copyright-item" data-v-582f9766><a href="https://www.segersian.com" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-582f9766>Made with ❤️ by Segers Ian</a></li></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.0ad86bdc.js" defer></script><script src="/assets/js/7.a7035712.js" defer></script><script src="/assets/js/4.378bc263.js" defer></script><script src="/assets/js/13.54549519.js" defer></script>
  </body>
</html>
